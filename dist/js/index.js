!function(t,r){function e(){this.dataList=[],this.now=0,this.startY=0}e.prototype.init=function(){var t=this;this.getDom(),this.getData(),r.progress.playTo(),r.audio.end(function(){r.render.stopRenderCurTime(),r.progress.stopRender(),t.btns[2].className="play",r.progress.currentTime=0,r.progress.currentLeft=0,r.render.minute=0,r.render.second=0,r.audio.status="pause"})},e.prototype.getDom=function(){this.oWrap=document.querySelector(".wrapper"),this.btns=document.querySelectorAll(".controls span"),this.menu=document.querySelector(".play-list-area"),this.closeBtn=document.querySelector(".play-list-area .close"),this.songList=document.querySelector(".play-list")},e.prototype.getData=function(){var e=this;t.ajax({url:"../mock/data.json",methods:"get",success:function(t){e.dataList=t,e.loadMusic(e.now),e.MusicControls()}})},e.prototype.loadMusic=function(t){r.render.init(this.dataList[t],this.dataList),r.audio.load(this.dataList[t].audioSrc)},e.prototype.MusicControls=function(){var s=this;this.btns[1].addEventListener("touchend",function(){0===s.now?alert("没有上一曲了呢"):(s.now--,s.loadMusic(s.now),r.render.minute=0,r.render.second=0,r.progress.currentTime=0,r.render.stopRenderCurTime(),r.progress.render(),"play"===r.audio.status?r.audio.play(s.dataList[s.now].duration):r.render.renderCurTime())}),this.btns[2].addEventListener("touchend",function(){"pause"===r.audio.status?(r.audio.play(s.dataList[s.now].duration),this.className="play pause"):"play"===r.audio.status&&(r.audio.pause(),this.className="play",r.render.stopRenderCurTime(),r.progress.stopRender())}),this.btns[3].addEventListener("touchend",function(){s.now===s.dataList.length-1?alert("没有下一曲了呢"):(s.now++,s.loadMusic(s.now),r.render.minute=0,r.render.second=0,r.progress.currentTime=0,r.render.stopRenderCurTime(),r.progress.render(),"play"===r.audio.status?r.audio.play(s.dataList[s.now].duration):r.render.renderCurTime())}),this.btns[4].addEventListener("touchend",function(){s.menu.style.display="block"}),this.closeBtn.addEventListener("touchend",function(){s.menu.style.display="none"}),this.songList.addEventListener("touchend",function(t){var e,n=t.changedTouches[0].clientY;5<Math.abs(n-s.startY)||"LI"===t.target.tagName&&(e=t.target.getAttribute("data-index"),s.now=+e,s.loadMusic(e),r.render.minute=0,r.render.second=0,r.render.stopRenderCurTime(),r.audio.play(s.dataList[s.now].duration),s.btns[2].className="play pause")}),this.songList.addEventListener("touchstart",function(t){s.startY=t.touches[0].clientY})};var n=new e;(r.musicPlayer=n).init()}(window.Zepto,window.player);